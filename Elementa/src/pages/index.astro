---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="ELEMENTA">
  <button
    class="element-panel-toggle"
    aria-label="Open element atlas"
    type="button"
  >
    <span></span>
    <span></span>
    <span></span>
  </button>

  <button class="sidebar-toggle" aria-label="Open entries modal" type="button">
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div id="app-container">
    <!-- Earth Page -->
    <div class="page active" id="earth-page" data-element="earth">
      <p class="prompt-text" data-prompts-id="earth"></p>
      <textarea
        class="text-input"
        placeholder="Write your reflection here..."
        aria-label="Earth reflection input"></textarea>
      <button class="save-btn" data-element="earth">Save Entry</button>
      <div class="record-container">
        <button
          class="record-btn"
          aria-label="Record voice note"
          data-element="earth"></button>
      </div>
    </div>

    <!-- Water Page -->
    <div class="page" id="water-page" data-element="water">
      <p class="prompt-text" data-prompts-id="water"></p>
      <textarea
        class="text-input"
        placeholder="Write your reflection here..."
        aria-label="Water reflection input"></textarea>
      <button class="save-btn" data-element="water">Save Entry</button>
      <div class="record-container">
        <button
          class="record-btn"
          aria-label="Record voice note"
          data-element="water"></button>
      </div>
    </div>

    <!-- Fire Page -->
    <div class="page" id="fire-page" data-element="fire">
      <p class="prompt-text" data-prompts-id="fire"></p>
      <textarea
        class="text-input"
        placeholder="Write your reflection here..."
        aria-label="Fire reflection input"></textarea>
      <button class="save-btn" data-element="fire">Save Entry</button>
      <div class="record-container">
        <button
          class="record-btn"
          aria-label="Record voice note"
          data-element="fire"></button>
      </div>
    </div>

    <!-- Air Page -->
    <div class="page" id="air-page" data-element="air">
      <p class="prompt-text" data-prompts-id="air"></p>
      <textarea
        class="text-input"
        placeholder="Write your reflection here..."
        aria-label="Air reflection input"></textarea>
      <button class="save-btn" data-element="air">Save Entry</button>
      <div class="record-container">
        <button
          class="record-btn"
          aria-label="Record voice note"
          data-element="air"></button>
      </div>
    </div>

    <!-- Spirit Page -->
    <div class="page" id="spirit-page" data-element="spirit">
      <p class="prompt-text" data-prompts-id="spirit"></p>
      <textarea
        class="text-input"
        placeholder="Write your reflection here..."
        aria-label="Spirit reflection input"></textarea>
      <button class="save-btn" data-element="spirit">Save Entry</button>
      <div class="record-container">
        <button
          class="record-btn"
          aria-label="Record voice note"
          data-element="spirit"></button>
      </div>
    </div>

    <!-- Sidebar Backdrop -->
    <div class="sidebar-backdrop"></div>

    <!-- Entries Sidebar -->
    <aside class="sidebar" aria-live="polite" aria-modal="true" role="dialog">
      <div class="sidebar-header">
        <h2 class="sidebar-title">Entries</h2>
        <button
          class="sidebar-close"
          type="button"
          aria-label="Close entries modal">×</button
        >
      </div>
      <div id="entries-list"></div>
      <div class="folder-list" id="folder-list"></div>
    </aside>

    <!-- Element Navigation Bar -->
    <nav class="nav-bar" aria-label="Element navigation">
      <div class="nav-item" data-element="earth" data-label="Earth"></div>
      <div class="nav-item" data-element="water" data-label="Water"></div>
      <div class="nav-item" data-element="fire" data-label="Fire"></div>
      <div class="nav-item" data-element="air" data-label="Air"></div>
      <div class="nav-item" data-element="spirit" data-label="Spirit"></div>
    </nav>
  </div>

  <!-- Element Panel Backdrop -->
  <div class="element-panel-backdrop"></div>

  <!-- Element Atlas Panel -->
  <aside
    class="element-panel"
    aria-live="polite"
    aria-modal="true"
    role="dialog"
    aria-hidden="true"
  >
    <div class="element-panel-inner">
      <div class="element-panel-header">
        <div>
          <p class="element-panel-eyebrow">Element Atlas</p>
          <p class="element-panel-subtitle">
            Pinch, drag, and tap each form to learn its geometry.
          </p>
        </div>
        <button
          class="element-panel-close"
          type="button"
          aria-label="Close element atlas">×</button
        >
      </div>
      <div
        class="element-panel-icons"
        id="element-panel-icons"
        role="tablist"
        aria-label="Element icons"
      >
      </div>
      <div class="element-panel-detail">
        <div class="element-panel-figure" id="element-panel-figure"></div>
        <div class="element-panel-copy">
          <p class="element-panel-name" id="element-panel-name"></p>
          <p class="element-panel-figure-type" id="element-panel-figure-type">
          </p>
          <p class="element-panel-description" id="element-panel-description">
          </p>
          <ul class="element-panel-facts" id="element-panel-facts"></ul>
        </div>
      </div>
    </div>
  </aside>

  <!-- Client-side JavaScript with Astro hydration -->
  <script>
    import { initApp } from "../lib/app/commander.js";

    // Initialize app when DOM is ready
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initApp);
    } else {
      initApp();
    }
  </script>
</BaseLayout>
